<div class="container mt-3">
  <h3>ğŸ’Š ReÃ§ete Listesi</h3>

  <div *ngIf="loading" class="text-center my-4">
    <mat-spinner diameter="40"></mat-spinner>
  </div>

  <div *ngIf="!loading && dataSource.data.length === 0" class="alert alert-info">
    HenÃ¼z reÃ§ete bulunmamaktadÄ±r.
  </div>

  <div *ngIf="!loading && dataSource.data.length > 0">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 w-100">

      <!-- E-ReÃ§ete Kodu -->
      <ng-container matColumnDef="prescriptionCode">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ReÃ§ete Kodu</th>
        <td mat-cell *matCellDef="let p">{{ p.prescriptionCode }}</td>
      </ng-container>

      <!-- Hasta -->
      <ng-container matColumnDef="patientName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Hasta</th>
        <td mat-cell *matCellDef="let p">{{ p.patientName }}</td>
      </ng-container>

      <!-- Doktor -->
      <ng-container matColumnDef="doctorName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Doktor</th>
        <td mat-cell *matCellDef="let p">{{ p.doctorName }}</td>
      </ng-container>

      <!-- Medical Record -->
      <ng-container matColumnDef="medicalRecordId">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Medical Record</th>
        <td mat-cell *matCellDef="let p">{{ p.medicalRecordId || 'â€”' }}</td>
      </ng-container>

      <!-- Ä°laÃ§ -->
      <ng-container matColumnDef="medication">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ä°laÃ§</th>
        <td mat-cell *matCellDef="let p">{{ p.medication }}</td>
      </ng-container>

      <!-- Dozaj -->
      <ng-container matColumnDef="dosage">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Dozaj</th>
        <td mat-cell *matCellDef="let p">{{ p.dosage }}</td>
      </ng-container>

      <!-- Talimatlar -->
      <ng-container matColumnDef="instructions">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Talimatlar</th>
        <td mat-cell *matCellDef="let p">{{ p.instructions }}</td>
      </ng-container>

      <!-- OluÅŸturulma Tarihi -->
      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>OluÅŸturulma</th>
        <td mat-cell *matCellDef="let p">{{ p.createdAt | date:'short' }}</td>
      </ng-container>

      <!-- GÃ¼ncellenme Tarihi -->
      <ng-container matColumnDef="updatedAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>GÃ¼ncellenme</th>
        <td mat-cell *matCellDef="let p">{{ p.updatedAt | date:'short' }}</td>
      </ng-container>

      <!-- Ä°ÅŸlemler (Sadece Doctor ve Admin) -->
      <ng-container matColumnDef="actions" *ngIf="role === 'DOCTOR' || role === 'ADMIN'">
        <th mat-header-cell *matHeaderCellDef>Ä°ÅŸlem</th>
        <td mat-cell *matCellDef="let p">
          <button mat-mini-fab color="primary" aria-label="Edit" (click)="editPrescription(p.id)">âœï¸</button>
          <button mat-mini-fab color="warn" aria-label="Delete" (click)="deletePrescription(p.id)">ğŸ—‘ï¸</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsWithActions"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsWithActions;"></tr>
    </table>

    <mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]"></mat-paginator>
  </div>
</div>
